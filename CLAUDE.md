# Aè‚¡åŸºé‡‘è‡ªåŠ¨äº¤æ˜“å¹³å° - AI Agent ä¸Šä¸‹æ–‡

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº Node.js/TypeScript çš„åœºå¤–åŸºé‡‘è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿï¼Œç”¨äºä¸ªäººæŠ•èµ„ç®¡ç†ã€‚ç³»ç»Ÿå®ç°äº†è‡ªåŠ¨å®šæŠ•ã€æ™ºèƒ½æ­¢ç›ˆæ­¢æŸã€ç­–ç•¥å›æµ‹å’Œå®æ—¶ç›‘æ§åŠŸèƒ½ã€‚

**é¡¹ç›®çŠ¶æ€**: âœ… Phase 1 MVP å·²å®Œæˆï¼Œå¯ç”¨äºå¼€å‘æµ‹è¯•

**å…³é”®ç‰¹æ€§**:

- è‡ªåŠ¨å®šæŠ•ï¼ˆæ—¥/å‘¨/æœˆé¢‘ç‡ï¼‰
- æ™ºèƒ½æ­¢ç›ˆæ­¢æŸï¼ˆç›®æ ‡æ”¶ç›Šç‡ã€ç§»åŠ¨æ­¢ç›ˆã€æœ€å¤§å›æ’¤ï¼‰
- ç­–ç•¥å›æµ‹ç³»ç»Ÿï¼ˆå†å²æ•°æ®éªŒè¯ï¼‰
- å¤šæ¸ é“é€šçŸ¥ï¼ˆTelegram/é£ä¹¦ï¼‰
- åŸºé‡‘å‡€å€¼è‡ªåŠ¨åŒæ­¥
- ä¼šè¯è‡ªåŠ¨ä¿æ´»
- Swagger API æ–‡æ¡£ï¼ˆäº¤äº’å¼æ¥å£æ–‡æ¡£ï¼‰

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: NestJS 11 + TypeScript 5.9
- **æ•°æ®åº“**: PostgreSQL 13+ + TypeORM 0.3
- **ä»»åŠ¡é˜Ÿåˆ—**: Bull 4 + Redis 6+
- **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: Puppeteer 24
- **é€šçŸ¥**: Telegram Bot API + é£ä¹¦ SDK
- **åŒ…ç®¡ç†**: pnpm

## é¡¹ç›®æ¶æ„

> **é‡è¦**: æœ¬é¡¹ç›®é‡‡ç”¨ Monorepo æ¶æ„ï¼Œä½¿ç”¨ pnpm workspaces ç®¡ç†å¤šä¸ªåŒ…ã€‚

### ç›®å½•ç»“æ„

```
fundTrader/                        # Monorepo æ ¹ç›®å½•
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ backend/                  # åç«¯æœåŠ¡åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹ï¼ˆ7ä¸ªå®ä½“ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ fund.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ fund-nav.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ position.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ transaction.entity.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ strategy.entity.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ backtest-result.entity.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ services/        # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ broker/     # äº¤æ˜“å¹³å°æ¥å…¥
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ tiantian.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data/       # æ•°æ®è·å–
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ fund-data.service.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ notify/     # é€šçŸ¥æœåŠ¡
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ notify.service.ts
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ telegram.service.ts
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ feishu.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ strategy/   # ç­–ç•¥å¼•æ“
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auto-invest.strategy.ts
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ take-profit-stop-loss.strategy.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ backtest/   # å›æµ‹ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ backtest.engine.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler/      # å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ trading.processor.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ data-sync.processor.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ api/            # REST API
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ controllers.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ dto.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ crypto.util.ts  # AES-256-GCM åŠ å¯†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ time.util.ts    # äº¤æ˜“æ—¶é—´åˆ¤æ–­
â”‚   â”‚   â”‚   â”œâ”€â”€ app.module.ts   # åº”ç”¨æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ main.ts         # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ default.yml
â”‚   â”‚   â”œâ”€â”€ .env.example       # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml # æ•°æ®åº“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ tsconfig.json      # TypeScript é…ç½®
â”‚   â”‚   â”œâ”€â”€ jest.config.js     # Jest é…ç½®
â”‚   â”‚   â””â”€â”€ package.json       # åç«¯åŒ…é…ç½®
â”‚   â”œâ”€â”€ shared/                # å‰åç«¯å…±äº«ä»£ç åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts      # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ enums.ts      # å…±äº«æšä¸¾
â”‚   â”‚   â”‚   â””â”€â”€ index.ts      # å¯¼å‡ºå…¥å£
â”‚   â”‚   â”œâ”€â”€ tsconfig.json     # TypeScript é…ç½®
â”‚   â”‚   â””â”€â”€ package.json      # Shared åŒ…é…ç½®
â”‚   â””â”€â”€ frontend/             # å‰ç«¯åº”ç”¨åŒ…ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ PLAN.md              # æŠ€æœ¯æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ IMPLEMENTATION.md    # å®æ–½æ€»ç»“
â”‚   â”œâ”€â”€ QUICKSTART.md        # å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ SECURITY_FIXES.md    # å®‰å…¨ä¿®å¤è®°å½•
â”‚   â”œâ”€â”€ CHECKLIST.md         # å¼€å‘æ£€æŸ¥æ¸…å•
â”‚   â””â”€â”€ SETUP.md             # ç¯å¢ƒé…ç½®æŒ‡å—
â”œâ”€â”€ pnpm-workspace.yaml       # pnpm workspace é…ç½®
â”œâ”€â”€ package.json              # æ ¹ package.jsonï¼ˆworkspace è„šæœ¬ï¼‰
â”œâ”€â”€ MONOREPO.md               # Monorepo ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ CLAUDE.md                 # AI Agent ä¸Šä¸‹æ–‡æ–‡æ¡£
â””â”€â”€ README.md                 # é¡¹ç›®è¯´æ˜
```

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### 1. æ•°æ®æ¨¡å‹å±‚ (models/)

- **User**: ç”¨æˆ·ä¿¡æ¯ï¼ŒåŠ å¯†å­˜å‚¨äº¤æ˜“å¹³å°å‡­è¯
- **Fund**: åŸºé‡‘åŸºæœ¬ä¿¡æ¯ï¼ˆä»£ç ã€åç§°ã€ç±»å‹ã€åŸºé‡‘ç»ç†ï¼‰
- **FundNav**: åŸºé‡‘å‡€å€¼å†å²æ•°æ®ï¼ˆæ—¶åºæ•°æ®ï¼‰
- **Position**: æŒä»“ä¿¡æ¯ï¼ˆä»½é¢ã€æˆæœ¬ã€æ”¶ç›Šç‡ï¼‰
- **Transaction**: äº¤æ˜“è®°å½•ï¼ˆä¹°å…¥/å–å‡ºã€çŠ¶æ€è·Ÿè¸ªï¼‰
- **Strategy**: ç­–ç•¥é…ç½®ï¼ˆå®šæŠ•/æ­¢ç›ˆ/æ­¢æŸå‚æ•°ï¼‰
- **BacktestResult**: å›æµ‹ç»“æœï¼ˆæ”¶ç›Šç‡ã€å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ï¼‰

#### 2. æœåŠ¡å±‚ (services/)

- **TiantianBrokerService**: å¤©å¤©åŸºé‡‘äº¤æ˜“å¹³å°æ¥å…¥
  - Puppeteer æ¨¡æ‹Ÿç™»å½•å’Œäº¤æ˜“
  - ä¼šè¯ç®¡ç†å’Œä¿æ´»
  - è®¢å•çŠ¶æ€æŸ¥è¯¢
- **FundDataService**: åŸºé‡‘æ•°æ®è·å–
  - ä»å¤©å¤©åŸºé‡‘ API è·å–å®æ—¶å‡€å€¼
  - å†å²å‡€å€¼æ•°æ®åŒæ­¥
- **NotifyService**: é€šçŸ¥æœåŠ¡
  - Telegram Bot é›†æˆ
  - é£ä¹¦æœºå™¨äººé›†æˆ
  - å¤šæ¸ é“å¹¶è¡Œé€šçŸ¥

#### 3. æ ¸å¿ƒä¸šåŠ¡å±‚ (core/)

- **AutoInvestStrategy**: å®šæŠ•ç­–ç•¥å¼•æ“
  - æ”¯æŒæ—¥/å‘¨/æœˆå®šæŠ•é¢‘ç‡
  - äº¤æ˜“æ—¶é—´æ£€æŸ¥ï¼ˆå·¥ä½œæ—¥ 15:00 å‰ï¼‰
  - è‡ªåŠ¨æ‰§è¡Œä¹°å…¥
- **TakeProfitStopLossStrategy**: æ­¢ç›ˆæ­¢æŸç­–ç•¥
  - ç›®æ ‡æ”¶ç›Šç‡æ­¢ç›ˆ
  - ç§»åŠ¨æ­¢ç›ˆï¼ˆtrailing stopï¼‰
  - æœ€å¤§å›æ’¤æ­¢æŸ
- **BacktestEngine**: å›æµ‹å¼•æ“
  - å†å²æ•°æ®å›æ”¾
  - ç­–ç•¥ä¿¡å·è¯„ä¼°
  - æ€§èƒ½æŒ‡æ ‡è®¡ç®—

#### 4. å®šæ—¶ä»»åŠ¡å±‚ (scheduler/)

- æ¯å¤© 09:00 åŒæ­¥åŸºé‡‘å‡€å€¼
- å·¥ä½œæ—¥ 14:30 æ£€æŸ¥å®šæŠ•ç­–ç•¥
- æ¯å°æ—¶æ£€æŸ¥æ­¢ç›ˆæ­¢æŸ
- æ¯ 30 åˆ†é’Ÿä¿æŒä¼šè¯æ´»è·ƒ

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª NestJS ä¾èµ–æ³¨å…¥æ¨¡å¼
- ä½¿ç”¨è£…é¥°å™¨è¿›è¡Œæ¨¡å—åŒ–è®¾è®¡
- æ–‡ä»¶å‘½åï¼škebab-caseï¼ˆå¦‚ `fund-data.service.ts`ï¼‰
- ç±»å‘½åï¼šPascalCaseï¼ˆå¦‚ `FundDataService`ï¼‰

### æ•°æ®åº“æ“ä½œ

- ä½¿ç”¨ TypeORM Repository æ¨¡å¼
- æ•æ„Ÿä¿¡æ¯ï¼ˆè´¦å·å¯†ç ï¼‰ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨
- æ—¶åºæ•°æ®ï¼ˆå‡€å€¼ï¼‰è€ƒè™‘ä½¿ç”¨ TimescaleDB æ‰©å±•ä¼˜åŒ–

### é”™è¯¯å¤„ç†

- æ‰€æœ‰å¤–éƒ¨è°ƒç”¨ï¼ˆAPIã€æ•°æ®åº“ã€æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼‰å¿…é¡»æœ‰é”™è¯¯å¤„ç†
- ä½¿ç”¨ NestJS å†…ç½®å¼‚å¸¸è¿‡æ»¤å™¨
- å…³é”®æ“ä½œå¤±è´¥æ—¶å‘é€é€šçŸ¥

### å®‰å…¨è¦æ±‚

- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- æ‰€æœ‰æ•æ„Ÿé…ç½®é€šè¿‡ç¯å¢ƒå˜é‡è¯»å–
- äº¤æ˜“å¹³å°å‡­è¯åŠ å¯†å­˜å‚¨åœ¨æ•°æ®åº“
- API æ¥å£éœ€è¦æ·»åŠ è®¤è¯å’Œé™æµ

### æµ‹è¯•è§„èŒƒ

#### æµ‹è¯•æ¡†æ¶

- **æµ‹è¯•æ¡†æ¶**: Jest 30.2.0
- **æµ‹è¯•å·¥å…·**: @nestjs/testing + ts-jest
- **è¦†ç›–ç‡ç›®æ ‡**: 80% (statements, branches, functions, lines)
- **æµ‹è¯•ç±»å‹**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•

#### æµ‹è¯•å‘½ä»¤

```bash
pnpm test          # è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test:watch    # ç›‘å¬æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
pnpm test:cov      # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
```

#### æµ‹è¯•æ–‡ä»¶ç»„ç»‡

æµ‹è¯•æ–‡ä»¶æ”¾åœ¨è¢«æµ‹è¯•æ–‡ä»¶åŒçº§çš„ `__tests__` ç›®å½•ä¸­ï¼š

```
src/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ time.util.ts
â”‚   â”œâ”€â”€ crypto.util.ts
â”‚   â””â”€â”€ __tests__/
â”‚       â”œâ”€â”€ time.util.test.ts
â”‚       â””â”€â”€ crypto.util.test.ts
â”œâ”€â”€ core/
â”‚   â””â”€â”€ strategy/
â”‚       â”œâ”€â”€ auto-invest.strategy.ts
â”‚       â””â”€â”€ __tests__/
â”‚           â””â”€â”€ auto-invest.strategy.test.ts
â””â”€â”€ services/
    â””â”€â”€ data/
        â”œâ”€â”€ fund-data.service.ts
        â””â”€â”€ __tests__/
            â””â”€â”€ fund-data.service.test.ts
```

#### æµ‹è¯•è¦†ç›–ç‡ç°çŠ¶

**å½“å‰è¦†ç›–ç‡**: 47.73% (78 ä¸ªæµ‹è¯•é€šè¿‡)

**å·²å®Œæˆæµ‹è¯•** (100% è¦†ç›–):
- âœ… `utils/` - å·¥å…·å‡½æ•° (æ—¶é—´ã€åŠ å¯†)
- âœ… `services/data/` - åŸºé‡‘æ•°æ®æœåŠ¡
- âœ… `services/notify/notify.service.ts` - é€šçŸ¥æœåŠ¡
- âœ… `core/strategy/` - å®šæŠ•å’Œæ­¢ç›ˆæ­¢æŸç­–ç•¥ (98.71%)

**éƒ¨åˆ†è¦†ç›–**:
- ğŸŸ¡ `core/backtest/` - å›æµ‹å¼•æ“ (68.26%)

**å¾…æµ‹è¯•æ¨¡å—**:
- âšª `api/` - REST API æ§åˆ¶å™¨
- âšª `scheduler/` - å®šæ—¶ä»»åŠ¡å¤„ç†å™¨
- âšª `services/broker/` - äº¤æ˜“å¹³å°æ¥å…¥
- âšª `services/notify/` - Telegram/é£ä¹¦æœåŠ¡

#### ç¼–å†™æµ‹è¯•çš„æœ€ä½³å®è·µ

1. **ä½¿ç”¨ NestJS Testing æ¨¡å—**
   ```typescript
   import { Test, TestingModule } from '@nestjs/testing';

   const module: TestingModule = await Test.createTestingModule({
     providers: [ServiceToTest, MockDependency],
   }).compile();
   ```

2. **Mock å¤–éƒ¨ä¾èµ–**
   - ä½¿ç”¨ `jest.fn()` åˆ›å»º mock å‡½æ•°
   - ä½¿ç”¨ `jest.Mocked<Type>` ç±»å‹åŒ– mock å¯¹è±¡
   - Mock æ•°æ®åº“ Repositoryã€å¤–éƒ¨ APIã€æµè§ˆå™¨è‡ªåŠ¨åŒ–

3. **æµ‹è¯•å‘½åè§„èŒƒ**
   - æ–‡ä»¶å: `*.test.ts` æˆ– `*.spec.ts`
   - describe: æè¿°è¢«æµ‹è¯•çš„ç±»æˆ–å‡½æ•°
   - it: æè¿°å…·ä½“çš„æµ‹è¯•åœºæ™¯ï¼ˆä½¿ç”¨ should è¯­å¥ï¼‰

4. **æµ‹è¯•è¦†ç›–è¦ç‚¹**
   - âœ… æ­£å¸¸æµç¨‹ï¼ˆhappy pathï¼‰
   - âœ… è¾¹ç•Œæ¡ä»¶ï¼ˆç©ºå€¼ã€æå€¼ï¼‰
   - âœ… é”™è¯¯å¤„ç†ï¼ˆå¼‚å¸¸ã€å¤±è´¥åœºæ™¯ï¼‰
   - âœ… ä¸šåŠ¡é€»è¾‘åˆ†æ”¯

5. **æ—¶é—´ç›¸å…³æµ‹è¯•**
   ```typescript
   jest.useFakeTimers();
   jest.setSystemTime(new Date('2026-02-25T14:00:00'));
   // ... æµ‹è¯•ä»£ç 
   jest.useRealTimers();
   ```

6. **å¼‚æ­¥æµ‹è¯•**
   ```typescript
   it('should handle async operation', async () => {
     const result = await service.asyncMethod();
     expect(result).toBeDefined();
   });
   ```

#### æµ‹è¯•æ³¨æ„äº‹é¡¹

- **ä¸è¦æµ‹è¯•å¤–éƒ¨æœåŠ¡**: Mock æ‰€æœ‰å¤–éƒ¨ API è°ƒç”¨
- **ä¸è¦ä¾èµ–çœŸå®æ•°æ®åº“**: ä½¿ç”¨ Mock Repository
- **ä¸è¦ä¾èµ–ç½‘ç»œ**: Mock axios ç­‰ HTTP å®¢æˆ·ç«¯
- **éš”ç¦»æµ‹è¯•**: æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„çŠ¶æ€
- **æ¸…ç†å‰¯ä½œç”¨**: ä½¿ç”¨ `afterEach` æ¸…ç† mock å’Œå®šæ—¶å™¨

## AI Agent å·¥ä½œæŒ‡å—

### ä¿®æ”¹ä»£ç æ—¶çš„æ³¨æ„äº‹é¡¹

1. **åœºå¤–åŸºé‡‘äº¤æ˜“ç‰¹æ€§**
   - T+1 ç¡®è®¤æœºåˆ¶ï¼šä»Šå¤©ä¹°å…¥ï¼Œæ˜å¤©ç¡®è®¤ä»½é¢
   - äº¤æ˜“æ—¶é—´é™åˆ¶ï¼šå·¥ä½œæ—¥ 15:00 å‰
   - å‡€å€¼æ›´æ–°å»¶è¿Ÿï¼šé€šå¸¸æ™šä¸Šæ›´æ–°
   - ä¿®æ”¹äº¤æ˜“ç›¸å…³é€»è¾‘æ—¶å¿…é¡»è€ƒè™‘è¿™äº›ç‰¹æ€§

2. **ä¸è¦ä¿®æ”¹çš„æ ¸å¿ƒé€»è¾‘**
   - åŠ å¯†ç®—æ³•ï¼ˆcrypto.util.tsï¼‰ï¼šå·²ä½¿ç”¨ AES-256-GCM
   - äº¤æ˜“æ—¶é—´åˆ¤æ–­ï¼ˆtime.util.tsï¼‰ï¼šå·²è€ƒè™‘å·¥ä½œæ—¥å’Œäº¤æ˜“æ—¶æ®µ
   - ä¼šè¯ç®¡ç†æœºåˆ¶ï¼šå·²å®ç°è‡ªåŠ¨ä¿æ´»

3. **å¯ä»¥ä¼˜åŒ–çš„éƒ¨åˆ†**
   - æ·»åŠ æ›´å¤šç­–ç•¥ç±»å‹ï¼ˆç½‘æ ¼äº¤æ˜“ã€åŠ¨æ€å†å¹³è¡¡ï¼‰
   - ä¼˜åŒ–å›æµ‹æ€§èƒ½ï¼ˆå¹¶è¡Œè®¡ç®—ã€ç¼“å­˜ï¼‰
   - æ·»åŠ  Web ç•Œé¢ï¼ˆReact/Vueï¼‰
   - å¢å¼ºé£æ§åŠŸèƒ½ï¼ˆå•æ—¥é™é¢ã€ä»“ä½é™åˆ¶ï¼‰

4. **æµ‹è¯•è¦æ±‚**
   - äº¤æ˜“ç›¸å…³åŠŸèƒ½å¿…é¡»å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
   - ä½¿ç”¨å°é¢èµ„é‡‘æµ‹è¯•å®é™…äº¤æ˜“
   - å›æµ‹ç³»ç»Ÿéœ€è¦éªŒè¯è®¡ç®—å‡†ç¡®æ€§
   - å®šæ—¶ä»»åŠ¡éœ€è¦éªŒè¯æ‰§è¡Œæ—¶é—´

### æ·»åŠ æ–°åŠŸèƒ½çš„æµç¨‹

1. **é˜…è¯»ç›¸å…³æ–‡æ¡£**
   - docs/PLAN.mdï¼šäº†è§£æ•´ä½“æ¶æ„è®¾è®¡
   - docs/IMPLEMENTATION.mdï¼šäº†è§£å·²å®ç°åŠŸèƒ½
   - ç›¸å…³æ¨¡å—çš„ç°æœ‰ä»£ç 

2. **éµå¾ªç°æœ‰æ¨¡å¼**
   - æ–°å¢ Entity éœ€è¦åœ¨ packages/backend/src/models/ ç›®å½•
   - æ–°å¢ Service éœ€è¦åœ¨ packages/backend/src/services/ ç›®å½•
   - æ–°å¢ç­–ç•¥éœ€è¦åœ¨ packages/backend/src/core/strategy/ ç›®å½•
   - å‰åç«¯å…±äº«çš„ç±»å‹å®šä¹‰æ”¾åœ¨ packages/shared/src/ ç›®å½•
   - ä½¿ç”¨ NestJS ä¾èµ–æ³¨å…¥

3. **æ›´æ–°é…ç½®**
   - æ–°å¢ç¯å¢ƒå˜é‡éœ€è¦æ›´æ–° packages/backend/.env.example
   - æ–°å¢é…ç½®é¡¹éœ€è¦æ›´æ–° packages/backend/config/default.yml
   - æ–°å¢ API éœ€è¦æ›´æ–° packages/backend/src/api/controllers.ts

4. **æ–‡æ¡£åŒæ­¥**
   - æ›´æ–° README.md çš„åŠŸèƒ½åˆ—è¡¨
   - æ›´æ–° docs/IMPLEMENTATION.md çš„å®ŒæˆçŠ¶æ€
   - å¦‚æœ‰é‡å¤§å˜æ›´ï¼Œæ›´æ–° docs/PLAN.md

### ç¦æ­¢çš„æ“ä½œ

1. **å®‰å…¨ç›¸å…³**
   - âŒ ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç  API å¯†é’¥ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯
   - âŒ ä¸è¦å°† .env æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
   - âŒ ä¸è¦ä¿®æ”¹åŠ å¯†ç®—æ³•æˆ–é™ä½å®‰å…¨çº§åˆ«
   - âŒ ä¸è¦è·³è¿‡äº¤æ˜“å¹³å°çš„å®‰å…¨éªŒè¯

2. **æ•°æ®ç›¸å…³**
   - âŒ ä¸è¦ç›´æ¥åˆ é™¤ç”Ÿäº§æ•°æ®åº“çš„æ•°æ®
   - âŒ ä¸è¦ä¿®æ”¹å·²ç¡®è®¤çš„äº¤æ˜“è®°å½•
   - âŒ ä¸è¦åœ¨æœªå¤‡ä»½çš„æƒ…å†µä¸‹æ‰§è¡Œæ•°æ®åº“è¿ç§»

3. **äº¤æ˜“ç›¸å…³**
   - âŒ ä¸è¦åœ¨éäº¤æ˜“æ—¶é—´æ‰§è¡Œäº¤æ˜“æ“ä½œ
   - âŒ ä¸è¦è·³è¿‡äº¤æ˜“é‡‘é¢å’ŒæŒä»“çš„éªŒè¯
   - âŒ ä¸è¦åœ¨æœªæµ‹è¯•çš„æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨çœŸå®èµ„é‡‘

4. **ä»£ç è´¨é‡**
   - âŒ ä¸è¦åˆ é™¤ç°æœ‰çš„é”™è¯¯å¤„ç†é€»è¾‘
   - âŒ ä¸è¦ç§»é™¤å…³é”®çš„æ—¥å¿—è®°å½•
   - âŒ ä¸è¦å¼•å…¥æœªå£°æ˜çš„ä¾èµ–

## ç¯å¢ƒé…ç½®

### å¿…éœ€çš„ç¯å¢ƒå˜é‡

```bash
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_password
DB_DATABASE=fundtrader

# Redis é…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379

# åŠ å¯†å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼‰
MASTER_KEY=your_secure_master_key_min_32_chars
ENCRYPTION_SALT=your_encryption_salt_min_16_chars

# é€šçŸ¥æœåŠ¡ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼‰
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id
FEISHU_APP_ID=your_app_id
FEISHU_APP_SECRET=your_app_secret
FEISHU_USER_ID=your_user_id

# äº¤æ˜“å¹³å°è´¦å·
TIANTIAN_USERNAME=your_username
TIANTIAN_PASSWORD=your_password
```

### å¿«é€Ÿå¯åŠ¨

```bash
# 1. å¯åŠ¨æ•°æ®åº“
pnpm dcup

# 2. å®‰è£…ä¾èµ–ï¼ˆåœ¨æ ¹ç›®å½•ï¼‰
pnpm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp packages/backend/.env.example packages/backend/.env
# ç¼–è¾‘ packages/backend/.env æ–‡ä»¶

# 4. å¯åŠ¨åº”ç”¨
pnpm dev
```

## å…³é”®æ–‡ä»¶è·¯å¾„

### é…ç½®æ–‡ä»¶

- `packages/backend/.env.example` - ç¯å¢ƒå˜é‡æ¨¡æ¿
- `packages/backend/config/default.yml` - åº”ç”¨é…ç½®
- `packages/backend/tsconfig.json` - åç«¯ TypeScript é…ç½®
- `packages/backend/docker-compose.yml` - æ•°æ®åº“æœåŠ¡é…ç½®
- `packages/shared/tsconfig.json` - Shared åŒ… TypeScript é…ç½®
- `pnpm-workspace.yaml` - pnpm workspace é…ç½®

### æ ¸å¿ƒä¸šåŠ¡

- `packages/backend/src/core/strategy/auto-invest.strategy.ts` - å®šæŠ•ç­–ç•¥
- `packages/backend/src/core/strategy/take-profit-stop-loss.strategy.ts` - æ­¢ç›ˆæ­¢æŸç­–ç•¥
- `packages/backend/src/core/backtest/backtest.engine.ts` - å›æµ‹å¼•æ“

### å…±äº«ä»£ç 

- `packages/shared/src/types.ts` - å‰åç«¯å…±äº«ç±»å‹å®šä¹‰
- `packages/shared/src/enums.ts` - å…±äº«æšä¸¾ç±»å‹
- `packages/shared/src/index.ts` - Shared åŒ…å¯¼å‡ºå…¥å£

### API æ–‡æ¡£

- Swagger UI: `http://localhost:3000/api/docs`
- Swagger JSON: `http://localhost:3000/api/docs-json`
- API é…ç½®: `packages/backend/src/main.ts` (DocumentBuilder)
- DTO è£…é¥°å™¨: `packages/backend/src/api/dto.ts` (@ApiProperty)
- Controller è£…é¥°å™¨: `packages/backend/src/api/controllers.ts` (@ApiTags, @ApiOperation)

### å¤–éƒ¨é›†æˆ

- `packages/backend/src/services/broker/tiantian.service.ts` - å¤©å¤©åŸºé‡‘æ¥å…¥
- `packages/backend/src/services/data/fund-data.service.ts` - åŸºé‡‘æ•°æ®è·å–
- `packages/backend/src/services/notify/notify.service.ts` - é€šçŸ¥æœåŠ¡

### å®šæ—¶ä»»åŠ¡

- `packages/backend/src/scheduler/scheduler.service.ts` - ä»»åŠ¡è°ƒåº¦
- `packages/backend/src/scheduler/trading.processor.ts` - äº¤æ˜“ä»»åŠ¡å¤„ç†
- `packages/backend/src/scheduler/data-sync.processor.ts` - æ•°æ®åŒæ­¥å¤„ç†

### å·¥å…·å‡½æ•°

- `packages/backend/src/utils/crypto.util.ts` - åŠ å¯†å·¥å…·ï¼ˆAES-256-GCMï¼‰
- `packages/backend/src/utils/time.util.ts` - æ—¶é—´å·¥å…·ï¼ˆäº¤æ˜“æ—¶é—´åˆ¤æ–­ï¼‰

### æµ‹è¯•æ–‡ä»¶

- `packages/backend/jest.config.js` - Jest é…ç½®æ–‡ä»¶
- `packages/backend/src/**/__tests__/*.test.ts` - å•å…ƒæµ‹è¯•æ–‡ä»¶
- æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š: `packages/backend/coverage/` ç›®å½•ï¼ˆè¿è¡Œ `pnpm test:cov` åç”Ÿæˆï¼‰

## é£é™©æç¤º

âš ï¸ **é‡è¦æç¤º**ï¼š

1. **äº¤æ˜“é£é™©**
   - è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿå¯èƒ½å› ç¨‹åºé”™è¯¯å¯¼è‡´æŸå¤±
   - å»ºè®®å…ˆç”¨å°é¢èµ„é‡‘æµ‹è¯•ç³»ç»Ÿç¨³å®šæ€§
   - è®¾ç½®å•æ—¥æœ€å¤§äº¤æ˜“é¢é™åˆ¶
   - é‡è¦æ“ä½œå¯å¢åŠ äººå·¥ç¡®è®¤ç¯èŠ‚

2. **å¹³å°é£æ§**
   - é¢‘ç¹ç™»å½•å¯èƒ½è§¦å‘å¹³å°é£æ§
   - éœ€è¦æ§åˆ¶ç™»å½•é¢‘ç‡ï¼Œæ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸º
   - å‡†å¤‡å¤‡ç”¨è´¦å·ä»¥é˜²ä¸»è´¦å·è¢«é™åˆ¶

3. **æ•°æ®å®‰å…¨**
   - ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ MASTER_KEY ä¸ºå¼ºå¯†ç 
   - å®šæœŸæ›´æ¢äº¤æ˜“å¹³å°å¯†ç 
   - å®šæœŸå¤‡ä»½æ•°æ®åº“
   - ä¸è¦å°† .env æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

4. **æ³•å¾‹åˆè§„**
   - ç¡®ä¿ä½¿ç”¨æ–¹å¼ç¬¦åˆå¹³å°æœåŠ¡æ¡æ¬¾
   - ä»…ä¾›ä¸ªäººå­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨
   - æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…

## å¼€å‘è·¯çº¿å›¾

### Phase 1: MVP âœ… å·²å®Œæˆ

- [x] é¡¹ç›®åˆå§‹åŒ–
- [x] æ•°æ®æ¨¡å‹
- [x] åŸºé‡‘æ•°æ®è·å–
- [x] äº¤æ˜“å¹³å°æ¥å…¥
- [x] å®šæŠ•ç­–ç•¥
- [x] é€šçŸ¥ç³»ç»Ÿ
- [x] å›æµ‹ç³»ç»Ÿ

### Phase 2: å®Œå–„åŠŸèƒ½ï¼ˆè¿›è¡Œä¸­ï¼‰

- [ ] æ­¢ç›ˆæ­¢æŸç­–ç•¥ä¼˜åŒ–
- [ ] Web ç•Œé¢å¼€å‘
- [ ] æ›´å¤šç­–ç•¥ç±»å‹
- [ ] æ€§èƒ½ä¼˜åŒ–

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆè§„åˆ’ä¸­ï¼‰

- [ ] å¤šè´¦æˆ·æ”¯æŒ
- [ ] é£é™©æ§åˆ¶å¢å¼º
- [ ] æ•°æ®åˆ†æå’Œå¯è§†åŒ–
- [ ] ç§»åŠ¨ç«¯ App

## å‚è€ƒæ–‡æ¡£

- [æŠ€æœ¯æ–¹æ¡ˆ](./docs/PLAN.md) - å®Œæ•´çš„æŠ€æœ¯æ¶æ„è®¾è®¡
- [å®æ–½æ€»ç»“](./docs/IMPLEMENTATION.md) - å·²å®ŒæˆåŠŸèƒ½æ¸…å•
- [å¿«é€Ÿå¼€å§‹](./docs/QUICKSTART.md) - éƒ¨ç½²å’Œä½¿ç”¨æŒ‡å—
- [å®‰å…¨ä¿®å¤](./docs/SECURITY_FIXES.md) - å®‰å…¨é—®é¢˜ä¿®å¤è®°å½•
